<!-- 오른쪽 리뷰 보기 + 작성 -->
<div class="column is-6 message hero is-fullheight" id="message-pane">
    <div class="box message-preview">
      {% if view == 'professor' and professor %}
        <h4 class="title is-4">{{ professor.name }} 교수님 리뷰</h4>
        <p class="subtitle is-6">소속: {{ professor.department }} / 평균 평점: ⭐{{ avg_rating or '없음' }}</p>
        <a class="button is-small is-info mt-2" href="/?view=lecture&search={{ professor.name }}">해당 교수 강의 보기</a>
      
        {% elif view == 'lecture' and lecture %}
        <h4 class="title is-4">강의: {{ lecture.title }}</h4>
        <p class="subtitle is-6">담당 교수: {{ lecture.professor_name }}</p>
        {% set prof = professors | selectattr('name', 'equalto', lecture.professor_name) | list | first %}
        {% if prof %}
        <a class="button is-small is-warning mt-2" href="/?view=professor&professor_id={{ prof.id }}">교수 리뷰 보기</a>
        {% endif %}

      {% else %}
        <p>좌측에서 항목을 선택하세요.</p>
      {% endif %}

      <hr>
      {% for r in reviews %}
        <article class="message is-info">
            <div class="message-header">
                <p>{{ r.writer }} ({{ '⭐' * r.rating }})</p>
                <small>{{ r.created_at }}</small>
            </div>
            <div class="message-body">
                {{ r.comment }}
            </div>
        </article>
      {% endfor %}

      <!--평점 영역-->
      {% if (view == 'professor' and professor) or (view == 'lecture' and lecture) %}
      <hr>
      <form method="post" action="/review/{{ view }}/{{ professor.id if view == 'professor' else lecture.id }}">
        <div class="field">
          <label class="label">작성자</label>
          <input class="input" name="writer" required>
        </div>
        <div class="field">
          <label class="label">비밀번호</label>
          <input class="input" type="password" name="password" required>
        </div>
        <div class="field">
          <label class="label">평점</label>
          <div class="select">
            <select name="rating">
              {% for i in range(5, 0, -1) %}
              <option value="{{ i }}">{{ i }}점</option>
              {% endfor %}
            </select>
          </div>
        </div>
        <div class="field">
          <label class="label">내용</label>
          <textarea class="textarea" name="comment" required></textarea>
        </div>
        <button class="button is-primary mt-2">리뷰 등록</button>
      </form>
      {% endif %}
    </div>
  </div>
</div>
